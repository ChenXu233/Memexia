# Memexia 项目需求文档

## 文档版本控制

## 1. 项目概述

### 1.1 项目名称
**Memexia** - 个人思想演化网络系统

### 1.2 项目愿景
构建一个融合Git的版本控制思想、TikTok的发现体验和GitHub的协作模式，用于管理非线性个人知识图谱的完整生态系统。

### 1.3 核心概念
Memexia旨在创建一种新的知识表示和管理范式，其中思想不是静态文档，而是动态、相互连接、持续演化的网络。系统追踪思想的诞生、分叉、连接和消亡，形成个人认知的"活地图"。

### 1.4 目标用户
1. **知识工作者**：研究员、学者、作家
2. **创意从业者**：设计师、艺术家、创意写作者
3. **学习者**：学生、终身学习者
4. **思考者**：哲学家、系统思考者、跨领域探索者

## 2. 系统架构

### 2.1 三层架构

#### 2.1.1 本地客户端层 (Rust)
- **功能定位**：类似Git的本地知识库管理
- **核心技术**：Oxigraph图数据库、FAISS向量数据库、SQLite元数据存储
- **存储结构**：`.memexia`隐藏目录 + 用户可见的Markdown文件结构

#### 2.1.2 用户界面层 (Svelte + Tauri/Electron)
- **功能定位**：直观的图形化操作界面
- **核心技术**：Cytoscape.js图可视化、Monaco编辑器、实时WebSocket通信
- **体验特征**：结合Obsidian的编辑体验 + Roam Research的连接思维 + TikTok的发现流

#### 2.1.3 云端服务层 (FastAPI + PostgreSQL + Neo4j)
- **功能定位**：类似GitHub的远程协作和发现平台
- **核心技术**：分布式同步协议、协作冲突解决、社区发现算法
- **服务模式**：SaaS托管 + 自部署选项

### 2.2 核心存储设计

#### 2.2.1 本地文件组织
```
项目目录/
├── .memexia/          # 系统内部数据（类似.git）
│   ├── graph/         # Oxigraph图数据库
│   ├── vectors/       # 向量索引
│   ├── objects/       # 内容对象存储
│   └── config/        # 配置和状态
├── notes/             # 用户Markdown文件（类似Obsidian）
├── assets/            # 媒体资源
└── memexia.toml       # 用户配置（可选）
```

#### 2.2.2 数据模型层次
1. **物理层**：文件系统中的Markdown文件和二进制资源
2. **对象层**：哈希寻址的内容对象（类似Git对象）
3. **图结构层**：Oxigraph中的RDF三元组存储
4. **索引层**：向量索引、全文索引、元数据索引
5. **视图层**：用户界面的可视化表示

## 3. 核心功能需求

### 3.1 知识库管理

#### 3.1.1 仓库操作
- **初始化**：在任意目录创建新的Memexia知识库
- **克隆**：从远程仓库克隆已有知识库
- **迁移**：从Obsidian、Roam Research等工具导入数据
- **归档**：导出完整知识库为便携格式

#### 3.1.2 配置管理
- **仓库配置**：名称、描述、许可协议、可见性
- **AI配置**：模型选择、API密钥、生成参数
- **同步配置**：远程仓库地址、自动同步频率
- **显示配置**：主题、布局偏好、快捷键

### 3.2 节点管理

#### 3.2.1 节点类型
1. **概念节点**：核心思想、理论、定义
2. **问题节点**：未解决的问题、研究问题
3. **证据节点**：数据、引用、实验证据
4. **资源节点**：书籍、文章、链接引用
5. **人物节点**：思想家、作者、协作者
6. **事件节点**：历史事件、个人时刻
7. **元节点**：对思想本身的反思

#### 3.2.2 内容格式
- **Markdown原生**：用户直接在文件中编辑
- **富媒体支持**：内嵌图片、音频、视频、PDF
- **代码支持**：语法高亮、执行环境（可选）
- **数学公式**：LaTeX支持
- **双向链接**：`[[页面名]]`语法

#### 3.2.3 元数据
- **技术元数据**：ID、创建时间、修改时间、版本哈希
- **语义元数据**：标签、分类、重要性评分
- **社会元数据**：作者、贡献者、引用次数
- **关系元数据**：入度、出度、中心性指标

### 3.3 连接管理

#### 3.3.1 预定义关系类型
1. **结构关系**
   - `CONTAINS`：包含关系（整体-部分）
   - `PART_OF`：部分关系（部分-整体）
   - `INSTANCE_OF`：实例关系

2. **逻辑关系**
   - `DERIVES_FROM`：推导自（逻辑推导）
   - `LEADS_TO`：导向（因果或时间顺序）
   - `SUPPORTS`：支持（证据支持）
   - `CONTRADICTS`：矛盾（逻辑对立）
   - `REFINES`：精炼（更精确表述）

3. **参考关系**
   - `REFERENCES`：引用（外部来源）
   - `RELATED_TO`：相关（一般性关联）
   - `ANALOGOUS_TO`：类比（相似但不同领域）

4. **时间关系**
   - `PRECEDES`：先于
   - `FOLLOWS`：后于
   - `SIMULTANEOUS`：同时

#### 3.3.2 关系属性
- **强度**：0-1的浮点数，表示关系强度
- **置信度**：AI生成时的置信水平
- **方向性**：有向或无向
- **描述**：自由文本描述关系的性质
- **证据**：支持该关系存在的引用

#### 3.3.3 连接创建方式
1. **手动创建**：用户明确指定两个节点的关系
2. **AI建议**：系统分析内容后推荐可能的关系
3. **自动推导**：基于现有关系推断新关系
4. **批量操作**：基于模式批量创建关系

### 3.4 图查询与遍历

#### 3.4.1 查询语言
- **SPARQL查询**：基于RDF的复杂图查询
- **自然语言查询**："显示所有支持自由意志的证据"
- **模式查询**：查找特定拓扑结构
- **语义搜索**：基于向量相似度的内容搜索

#### 3.4.2 遍历模式
1. **深度优先**：探索单个分支到最深
2. **广度优先**：均匀探索所有方向
3. **随机游走**：发现性探索
4. **重要性优先**：优先访问重要节点
5. **新颖性优先**：优先访问未充分探索的区域

#### 3.4.3 分析功能
- **社区检测**：自动发现概念集群
- **中心性分析**：识别枢纽概念
- **路径查找**：找到两个概念之间的所有路径
- **循环检测**：发现循环论证或自指结构
- **瓶颈识别**：找到知识网络中的薄弱环节

### 3.5 版本控制与历史

#### 3.5.1 Git式操作
- `memexia init`：初始化新仓库
- `memexia add`：添加文件到暂存区
- `memexia commit`：提交当前状态
- `memexia branch`：创建思想分支
- `memexia merge`：合并不同分支的思想
- `memexia log`：查看思想演变历史

#### 3.5.2 特殊版本控制需求
1. **节点级别版本**：单个节点的修改历史
2. **关系版本**：连接关系的创建和删除历史
3. **图结构快照**：整个知识图谱的状态快照
4. **分支语义化**：分支代表不同的思想方向或假设

#### 3.5.3 冲突解决
- **内容冲突**：同一节点在不同分支被修改
- **结构冲突**：图结构在不同分支分歧
- **关系冲突**：同一对节点有不同关系类型
- **解决策略**：手动合并、保留两者、创建合成节点

### 3.6 AI增强功能

#### 3.6.1 智能连接发现
- **语义相似性**：基于向量嵌入发现相关概念
- **模式识别**：识别常见论证模式
- **跨领域桥梁**：发现不同领域间的类比
- **空白识别**：识别知识网络中的缺失连接

#### 3.6.2 内容生成与扩展
- **概念延伸**：基于现有概念生成相关新概念
- **问题生成**：自动生成值得探索的问题
- **反证生成**：为观点生成对立观点
- **摘要生成**：为复杂子图生成文字摘要

#### 3.6.3 个性化适应
- **学习用户风格**：适应用户的思维和写作风格
- **兴趣预测**：预测用户可能感兴趣的方向
- **难度适应**：根据用户水平调整内容复杂度

### 3.7 发现与探索

#### 3.7.1 TikTok式信息流
1. **For You流**：基于用户兴趣的个性化发现
2. **趋势流**：当前热门的主题和连接
3. **本地流**：与当前查看内容相关的内容
4. **随机流**：完全随机的探索模式

#### 3.7.2 探索模式
- **导游模式**：系统引导的思维旅程
- **自由探索**：用户主导的随意浏览
- **目标导向**：到达特定知识目标的导航
- **对比探索**：并排比较相关但不同的概念

#### 3.7.3 推荐算法
- **协同过滤**：类似兴趣用户的模式
- **内容推荐**：基于语义相似性
- **结构推荐**：基于图拓扑结构
- **时序推荐**：基于用户最近活动

### 3.8 同步与协作

#### 3.8.1 同步协议
- **增量同步**：只传输变化部分
- **冲突检测**：自动检测并标记冲突
- **选择性同步**：用户选择同步哪些分支
- **离线支持**：完全离线工作，上线时同步

#### 3.8.2 协作功能
1. **分支协作**：多人基于同一分支工作
2. **合并请求**：提议合并思想分支
3. **评论系统**：节点和关系的讨论
4. **提及通知**：@提及其他用户
5. **更改追踪**：谁在何时修改了什么

#### 3.8.3 权限系统
- **读取权限**：谁可以查看内容
- **写入权限**：谁可以修改内容
- **管理权限**：谁可以管理仓库设置
- **分支权限**：基于分支的细粒度控制

### 3.9 可视化与交互

#### 3.9.1 图可视化
- **力导向布局**：基于物理模拟的自动布局
- **分层布局**：基于分类或重要性的层次布局
- **时间线布局**：按时间顺序排列
- **聚焦+上下文**：当前焦点与整体上下文结合
- **动画过渡**：平滑的状态转换动画

#### 3.9.2 交互模式
1. **点击交互**：选择节点、查看详情、编辑
2. **拖拽交互**：重新布局、创建连接
3. **手势交互**：缩放、平移、旋转（触摸设备）
4. **键盘导航**：快捷键快速操作
5. **语音命令**：语音控制（可选）

#### 3.9.3 多视图系统
- **图视图**：完整的网络可视化
- **大纲视图**：层次化大纲展示
- **时间线视图**：按时间顺序展示
- **表格视图**：结构化数据查看
- **画廊视图**：可视化媒体内容

### 3.10 数据导入导出

#### 3.10.1 导入格式支持
- **Markdown批量**：从Obsidian、Logseq等导入
- **OPML**：大纲格式导入
- **BibTeX**：学术引用导入
- **CSV/JSON**：结构化数据导入
- **Web抓取**：从网页提取内容（可选）

#### 3.10.2 导出格式支持
- **静态网站**：导出为可浏览的HTML网站
- **电子书**：PDF、EPUB格式
- **演示文稿**：基于思想路径的幻灯片
- **学术论文**：符合出版格式的LaTeX
- **API访问**：通过REST API访问数据

## 4. 非功能需求

### 4.1 性能需求

#### 4.1.1 响应时间
- **本地操作**：节点创建/编辑 < 100ms
- **图布局**：1000个节点的初始布局 < 2s
- **搜索**：全库搜索 < 500ms
- **同步**：增量同步 < 1s（正常网络条件）

#### 4.1.2 容量需求
- **节点数量**：支持至少100,000个节点
- **关系数量**：支持至少500,000个关系
- **文件大小**：单个节点支持10MB内容
- **总仓库大小**：支持1TB以上的总数据

#### 4.1.3 并发需求
- **本地并发**：支持多标签同时编辑
- **同步并发**：支持多人同时编辑不同部分
- **AI请求**：支持队列和限流的AI请求

### 4.2 可用性需求

#### 4.2.1 学习曲线
- **新手用户**：30分钟内完成第一个知识库创建
- **中级用户**：1周内掌握核心功能
- **高级用户**：1月内掌握所有高级功能

#### 4.2.2 可访问性
- **屏幕阅读器**：支持主流屏幕阅读器
- **键盘导航**：所有功能可通过键盘访问
- **颜色对比**：符合WCAG 2.1 AA标准
- **字体大小**：支持放大至200%不影响功能

#### 4.2.3 错误处理
- **操作撤销**：支持多级撤销/重做
- **数据恢复**：误删数据可恢复
- **冲突处理**：清晰的冲突解决界面
- **错误信息**：用户友好的错误提示

### 4.3 可靠性需求

#### 4.3.1 数据完整性
- **自动备份**：定期自动备份到安全位置
- **损坏检测**：自动检测数据损坏并修复
- **版本回滚**：可回滚到任意历史版本
- **操作日志**：完整记录所有重要操作

#### 4.3.2 系统稳定性
- **崩溃恢复**：崩溃后恢复未保存工作
- **内存管理**：优雅处理内存不足情况
- **长时间运行**：支持连续运行30天不重启
- **资源清理**：自动清理临时文件和缓存

### 4.4 安全性需求

#### 4.4.1 数据安全
- **本地加密**：敏感数据的本地加密存储
- **传输加密**：所有网络传输使用TLS 1.3
- **访问控制**：基于角色的细粒度权限控制
- **审计日志**：安全相关事件的完整日志

#### 4.4.2 隐私保护
- **数据所有权**：用户完全拥有自己的数据
- **隐私设置**：详细的隐私控制选项
- **匿名模式**：可选的匿名使用模式
- **数据删除**：完全的数据删除功能

### 4.5 兼容性需求

#### 4.5.1 平台兼容性
- **桌面操作系统**：Windows 10/11, macOS 10.15+, Linux主流发行版
- **移动设备**：iOS 14+, Android 10+（远期目标）
- **浏览器**：Chrome 90+, Firefox 88+, Safari 14+（Web版）

#### 4.5.2 文件格式兼容性
- **Markdown方言**：CommonMark + GFM + 常用扩展
- **图片格式**：PNG, JPG, GIF, WebP, SVG
- **文档格式**：PDF, Word, PowerPoint（预览）
- **代码格式**：所有主流编程语言语法高亮

### 4.6 可维护性需求

#### 4.6.1 代码质量
- **测试覆盖率**：核心功能测试覆盖率 > 80%
- **代码文档**：所有公共API有完整文档
- **架构文档**：系统架构和设计决策文档
- **依赖管理**：明确的依赖版本和更新策略

#### 4.6.2 可扩展性
- **插件系统**：支持第三方插件扩展功能
- **API设计**：清晰的内外部API设计
- **配置系统**：灵活的配置文件系统
- **主题系统**：完全可定制的界面主题

## 5. 开发约束

### 5.1 技术栈约束
- **后端核心**：必须使用Rust实现
- **图数据库**：必须使用Oxigraph
- **前端框架**：必须使用Svelte
- **构建系统**：必须使用Cargo和npm/yarn/pnpm
- **打包工具**：必须支持Tauri和Electron双打包选项

### 5.2 许可证约束
- **核心代码**：必须采用MIT或Apache 2.0许可证
- **依赖项**：所有依赖必须为兼容的开源许可证
- **分发**：必须提供开源版本和商业版本选项

### 5.3 时间约束
- **MVP版本**：3个月内完成可用的最小可行产品
- **完整版本**：12个月内完成所有核心功能
- **维护周期**：至少提供3年的维护更新

### 5.4 资源约束
- **开发团队**：初始阶段为1-2人开发团队
- **基础设施**：使用低成本云服务起步
- **第三方服务**：最小化对第三方API的依赖

## 6. 验收标准

### 6.1 功能验收标准

#### 6.1.1 MVP版本（v0.1.0）
- [ ] 用户能创建本地知识库
- [ ] 用户能添加、编辑、删除Markdown节点
- [ ] 用户能手动创建节点间连接
- [ ] 系统能可视化显示知识图谱
- [ ] 支持基本的Git式版本控制
- [ ] 本地图数据库能存储和查询数据

#### 6.1.2 完整版本（v1.0.0）
- [ ] 实现所有预定义关系类型
- [ ] AI辅助的连接发现功能
- [ ] 完整的同步和协作功能
- [ ] TikTok式发现信息流
- [ ] 多视图可视化系统
- [ ] 全面的导入导出功能

### 6.2 性能验收标准
- [ ] 1000节点图谱加载时间 < 2秒
- [ ] 搜索响应时间 < 500ms
- [ ] 内存使用稳定，无内存泄漏
- [ ] 离线操作完全可用

### 6.3 用户体验验收标准
- [ ] 新手教程完成率 > 80%
- [ ] 用户满意度评分 > 4/5
- [ ] 每周活跃用户留存率 > 40%
- [ ] 平均会话时长 > 15分钟

## 7. 部署与维护

### 7.1 部署架构

#### 7.1.1 本地部署
- **桌面应用**：通过安装包分发
- **便携版本**：无需安装的绿色版本
- **开发模式**：源代码直接运行

#### 7.1.2 云端部署
- **SaaS服务**：托管在memexia.com
- **企业自托管**：Docker容器部署
- **混合模式**：本地客户端+云端同步

### 7.2 更新机制
- **自动更新**：后台自动下载和安装更新
- **手动更新**：用户手动触发更新
- **版本回退**：可回退到前一稳定版本
- **增量更新**：只下载变化部分

### 7.3 监控与维护
- **错误报告**：自动收集和报告错误
- **使用统计**：匿名使用数据收集（可选）
- **性能监控**：监控响应时间和资源使用
- **备份策略**：自动备份和灾难恢复

## 8. 未来扩展方向

### 8.1 短期扩展（1年内）
- **移动应用**：完整的iOS和Android应用
- **浏览器扩展**：网页内容快速抓取
- **语音输入**：语音创建和编辑节点
- **实时协作**：Google Docs式实时协作

### 8.2 中期扩展（1-3年）
- **团队协作**：企业级团队知识管理
- **教育集成**：学习管理系统集成
- **API市场**：第三方应用和服务集成
- **区块链集成**：思想贡献的不可变记录

### 8.3 长期愿景（3-5年）
- **集体智能**：跨用户的知识网络连接
- **预测分析**：预测思想发展趋势
- **AR/VR界面**：沉浸式思想探索
- **神经接口**：脑机接口直接输入（实验性）

## 9. 附录

### 9.1 术语表
- **Memexia**：本项目名称，源自Memex（记忆扩展器）+ ia（领域）
- **节点**：知识的基本单位，包含内容和元数据
- **边/连接**：节点间的关系，有类型和属性
- **知识库**：节点和边的集合，构成完整知识图谱
- **分支**：思想的不同发展方向或假设
- **推导**：从现有节点生成新节点的过程

### 9.2 参考项目
- **Obsidian**：Markdown笔记应用，双向链接
- **Roam Research**：网状笔记工具，每日笔记
- **Logseq**：大纲式知识管理，本地优先
- **Notion**：一体化工作空间，数据库功能
- **Git**：分布式版本控制系统
- **TikTok**：短视频发现平台，推荐算法

### 9.3 设计原则
1. **本地优先**：数据首先存储在用户设备
2. **用户主权**：用户完全控制自己的数据
3. **渐进复杂**：从简单开始，逐渐揭示复杂性
4. **思想友好**：适应人类思维的非线性特性
5. **开放生态**：支持扩展和集成

---

本需求文档定义了Memexia项目的完整范围和要求。项目将分阶段实施，优先实现核心价值功能，逐步扩展到完整生态系统。所有开发决策都应以此文档为指导，确保项目方向的一致性和完整性。